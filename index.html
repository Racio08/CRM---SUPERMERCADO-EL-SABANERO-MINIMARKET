<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM - Supermercado El Sabanero</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bronze: #cd7f32;
            --silver: #c0c0c0;
            --gold: #ffd700;
            --platinum: #e5e4e2;
            --bg-light: #f8fafc;
            --text-dark: #1e293b;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: var(--bg-light);
            border-bottom: 2px solid var(--border);
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            background: white;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-dark);
            transition: all 0.3s;
            border-right: 1px solid var(--border);
        }

        .tab:last-child {
            border-right: none;
        }

        .tab:hover {
            background: var(--bg-light);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .customer-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-item {
            padding: 15px;
            background: var(--bg-light);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .info-item strong {
            display: block;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-top: 5px;
        }

        .badge-bronze {
            background: var(--bronze);
            color: white;
        }

        .badge-silver {
            background: var(--silver);
            color: var(--text-dark);
        }

        .badge-gold {
            background: var(--gold);
            color: var(--text-dark);
        }

        .badge-platinum {
            background: linear-gradient(135deg, #e5e4e2 0%, #b8b8b8 100%);
            color: var(--text-dark);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .reward-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }

        .reward-card:hover {
            border-color: var(--primary);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .reward-card h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .reward-points {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--success);
            margin: 10px 0;
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid var(--success);
        }

        .message.error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid var(--danger);
        }

        .search-bar {
            position: relative;
            margin-bottom: 20px;
        }

        .search-bar input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1.1em;
        }

        .search-bar::after {
            content: 'üîç';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-dark);
        }

        tr:hover {
            background: var(--bg-light);
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: var(--text-dark);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè™ SUPERMERCADO EL SABANERO</h1>
            <p>Sistema de Identificaci√≥n y Fidelizaci√≥n de Clientes</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('clientes')">üë• Clientes</button>
            <button class="tab" onclick="showTab('compras')">üõí Compras</button>
            <button class="tab" onclick="showTab('recompensas')">üéÅ Recompensas</button>
            <button class="tab" onclick="showTab('estadisticas')">üìä Estad√≠sticas</button>
        </div>

        <div class="content">
            <!-- TAB: CLIENTES -->
            <div id="clientes" class="tab-content active">
                <h2>Gesti√≥n de Clientes</h2>
                
                <div id="message-clientes" class="message"></div>

                <div class="grid-2">
                    <div class="card">
                        <h3>Registrar Nuevo Cliente</h3>
                        <form id="form-nuevo-cliente">
                            <div class="form-group">
                                <label>C√©dula *</label>
                                <input type="text" id="cedula" required>
                            </div>
                            <div class="form-group">
                                <label>Nombre *</label>
                                <input type="text" id="nombre" required>
                            </div>
                            <div class="form-group">
                                <label>Apellido *</label>
                                <input type="text" id="apellido" required>
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="email">
                            </div>
                            <div class="form-group">
                                <label>Tel√©fono</label>
                                <input type="tel" id="telefono">
                            </div>
                            <div class="form-group">
                                <label>Direcci√≥n</label>
                                <input type="text" id="direccion">
                            </div>
                            <button type="submit" class="btn btn-primary">Registrar Cliente</button>
                        </form>
                    </div>

                    <div class="card">
                        <h3>Buscar Cliente</h3>
                        <div class="search-bar">
                            <input type="text" id="buscar-cedula" placeholder="Ingrese c√©dula del cliente...">
                        </div>
                        <button onclick="buscarCliente()" class="btn btn-primary">Buscar</button>
                        
                        <div id="info-cliente" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h3>Lista de Clientes</h3>
                    <div id="lista-clientes"></div>
                </div>
            </div>

            <!-- TAB: COMPRAS -->
            <div id="compras" class="tab-content">
                <h2>Registro de Compras</h2>
                
                <div id="message-compras" class="message"></div>

                <div class="card">
                    <h3>Registrar Nueva Compra</h3>
                    <form id="form-nueva-compra">
                        <div class="form-group">
                            <label>C√©dula del Cliente *</label>
                            <input type="text" id="compra-cedula" required>
                            <button type="button" onclick="verificarClienteCompra()" class="btn btn-primary" style="margin-top: 10px;">Verificar Cliente</button>
                        </div>
                        <div id="cliente-compra-info"></div>
                        <div class="form-group">
                            <label>Total de la Compra ($) *</label>
                            <input type="number" step="0.01" id="compra-total" required>
                        </div>
                        <div class="form-group">
                            <label>N√∫mero de Factura</label>
                            <input type="text" id="compra-factura">
                        </div>
                        <div class="form-group">
                            <label>Descripci√≥n</label>
                            <input type="text" id="compra-descripcion">
                        </div>
                        <button type="submit" class="btn btn-success">Registrar Compra</button>
                    </form>
                </div>
            </div>

            <!-- TAB: RECOMPENSAS -->
            <div id="recompensas" class="tab-content">
                <h2>Cat√°logo de Recompensas</h2>
                
                <div id="message-recompensas" class="message"></div>

                <div class="card">
                    <h3>Canjear Recompensa</h3>
                    <div class="form-group">
                        <label>C√©dula del Cliente</label>
                        <input type="text" id="canje-cedula">
                        <button onclick="cargarRecompensasCliente()" class="btn btn-primary" style="margin-top: 10px;">Ver Recompensas Disponibles</button>
                    </div>
                    <div id="recompensas-cliente"></div>
                </div>

                <div class="card">
                    <h3>Todas las Recompensas</h3>
                    <div id="lista-recompensas" class="rewards-grid"></div>
                </div>
            </div>

            <!-- TAB: ESTAD√çSTICAS -->
            <div id="estadisticas" class="tab-content">
                <h2>Estad√≠sticas del Sistema</h2>
                
                <div id="stats-general" class="stats-grid"></div>

                <div class="card" style="margin-top: 20px;">
                    <h3>Clientes por Nivel de Fidelidad</h3>
                    <div id="stats-niveles"></div>
                </div>

                <div class="card">
                    <h3>Top 10 Clientes</h3>
                    <div id="top-clientes"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5000/api';
        let clienteActualCompra = null;

        // ==================== FUNCIONES DE TABS ====================
        function showTab(tabName) {
            // Ocultar todos los tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Mostrar tab seleccionado
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // Cargar datos seg√∫n el tab
            if (tabName === 'clientes') {
                cargarClientes();
            } else if (tabName === 'recompensas') {
                cargarRecompensas();
            } else if (tabName === 'estadisticas') {
                cargarEstadisticas();
            }
        }

        // ==================== FUNCIONES DE CLIENTES ====================
        document.getElementById('form-nuevo-cliente').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const datos = {
                cedula: document.getElementById('cedula').value,
                nombre: document.getElementById('nombre').value,
                apellido: document.getElementById('apellido').value,
                email: document.getElementById('email').value || null,
                telefono: document.getElementById('telefono').value || null,
                direccion: document.getElementById('direccion').value || null
            };

            try {
                const response = await fetch(`${API_URL}/clientes`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(datos)
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage('clientes', '‚úÖ Cliente registrado exitosamente', 'success');
                    e.target.reset();
                    cargarClientes();
                } else {
                    showMessage('clientes', '‚ùå ' + result.error, 'error');
                }
            } catch (error) {
                showMessage('clientes', '‚ùå Error al conectar con el servidor', 'error');
            }
        });

        async function buscarCliente() {
            const cedula = document.getElementById('buscar-cedula').value;
            if (!cedula) return;

            try {
                const response = await fetch(`${API_URL}/clientes/buscar/${cedula}`);
                const cliente = await response.json();

                if (response.ok) {
                    mostrarInfoCliente(cliente);
                } else {
                    document.getElementById('info-cliente').innerHTML = '<p style="color: red;">Cliente no encontrado</p>';
                }
            } catch (error) {
                showMessage('clientes', '‚ùå Error al buscar cliente', 'error');
            }
        }

        function mostrarInfoCliente(cliente) {
            const badgeClass = `badge-${cliente.nivel_fidelidad.toLowerCase()}`;
            const html = `
                <div class="customer-info">
                    <div class="info-item">
                        <strong>Nombre Completo</strong>
                        ${cliente.nombre} ${cliente.apellido}
                    </div>
                    <div class="info-item">
                        <strong>C√©dula</strong>
                        ${cliente.cedula}
                    </div>
                    <div class="info-item">
                        <strong>Email</strong>
                        ${cliente.email || 'No registrado'}
                    </div>
                    <div class="info-item">
                        <strong>Tel√©fono</strong>
                        ${cliente.telefono || 'No registrado'}
                    </div>
                    <div class="info-item">
                        <strong>Puntos Acumulados</strong>
                        <div style="font-size: 1.5em; color: #10b981; font-weight: bold;">${cliente.puntos_acumulados}</div>
                    </div>
                    <div class="info-item">
                        <strong>Nivel de Fidelidad</strong>
                        <span class="badge ${badgeClass}">${cliente.nivel_fidelidad}</span>
                    </div>
                </div>
            `;
            document.getElementById('info-cliente').innerHTML = html;
        }

        async function cargarClientes() {
            try {
                const response = await fetch(`${API_URL}/clientes`);
                const clientes = await response.json();

                let html = '<table><tr><th>C√©dula</th><th>Nombre</th><th>Email</th><th>Puntos</th><th>Nivel</th></tr>';
                
                clientes.forEach(cliente => {
                    const badgeClass = `badge-${cliente.nivel_fidelidad.toLowerCase()}`;
                    html += `
                        <tr>
                            <td>${cliente.cedula}</td>
                            <td>${cliente.nombre} ${cliente.apellido}</td>
                            <td>${cliente.email || '-'}</td>
                            <td><strong>${cliente.puntos_acumulados}</strong></td>
                            <td><span class="badge ${badgeClass}">${cliente.nivel_fidelidad}</span></td>
                        </tr>
                    `;
                });
                
                html += '</table>';
                document.getElementById('lista-clientes').innerHTML = html;
            } catch (error) {
                document.getElementById('lista-clientes').innerHTML = '<p>Error al cargar clientes</p>';
            }
        }

        // ==================== FUNCIONES DE COMPRAS ====================
        async function verificarClienteCompra() {
            const cedula = document.getElementById('compra-cedula').value;
            if (!cedula) return;

            try {
                const response = await fetch(`${API_URL}/clientes/buscar/${cedula}`);
                const cliente = await response.json();

                if (response.ok) {
                    clienteActualCompra = cliente;
                    const badgeClass = `badge-${cliente.nivel_fidelidad.toLowerCase()}`;
                    document.getElementById('cliente-compra-info').innerHTML = `
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <strong>Cliente:</strong> ${cliente.nombre} ${cliente.apellido}<br>
                            <strong>Nivel:</strong> <span class="badge ${badgeClass}">${cliente.nivel_fidelidad}</span><br>
                            <strong>Puntos Actuales:</strong> ${cliente.puntos_acumulados}
                        </div>
                    `;
                } else {
                    showMessage('compras', '‚ùå Cliente no encontrado', 'error');
                    clienteActualCompra = null;
                }
            } catch (error) {
                showMessage('compras', '‚ùå Error al verificar cliente', 'error');
            }
        }

        document.getElementById('form-nueva-compra').addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!clienteActualCompra) {
                showMessage('compras', '‚ùå Primero debe verificar el cliente', 'error');
                return;
            }

            const datos = {
                cliente_id: clienteActualCompra.id,
                total: parseFloat(document.getElementById('compra-total').value),
                numero_factura: document.getElementById('compra-factura').value || null,
                descripcion: document.getElementById('compra-descripcion').value || null
            };

            try {
                const response = await fetch(`${API_URL}/compras`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(datos)
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage('compras', `‚úÖ ${result.mensaje}`, 'success');
                    e.target.reset();
                    document.getElementById('cliente-compra-info').innerHTML = '';
                    clienteActualCompra = null;
                } else {
                    showMessage('compras', '‚ùå Error al registrar compra', 'error');
                }
            } catch (error) {
                showMessage('compras', '‚ùå Error al conectar con el servidor', 'error');
            }
        });

        // ==================== FUNCIONES DE RECOMPENSAS ====================
        async function cargarRecompensas() {
            try {
                const response = await fetch(`${API_URL}/recompensas`);
                const recompensas = await response.json();

                let html = '';
                recompensas.forEach(recompensa => {
                    html += `
                        <div class="reward-card">
                            <h3>${recompensa.nombre}</h3>
                            <p>${recompensa.descripcion}</p>
                            <div class="reward-points">${recompensa.puntos_requeridos} puntos</div>
                            <span class="badge badge-${recompensa.nivel_minimo.toLowerCase()}">${recompensa.nivel_minimo}+</span>
                            ${recompensa.valor ? `<p><strong>Valor: $${recompensa.valor}</strong></p>` : ''}
                        </div>
                    `;
                });

                document.getElementById('lista-recompensas').innerHTML = html;
            } catch (error) {
                document.getElementById('lista-recompensas').innerHTML = '<p>Error al cargar recompensas</p>';
            }
        }

        async function cargarRecompensasCliente() {
            const cedula = document.getElementById('canje-cedula').value;
            if (!cedula) return;

            try {
                const responseCliente = await fetch(`${API_URL}/clientes/buscar/${cedula}`);
                const cliente = await responseCliente.json();

                if (!responseCliente.ok) {
                    showMessage('recompensas', '‚ùå Cliente no encontrado', 'error');
                    return;
                }

                const responseRecompensas = await fetch(`${API_URL}/clientes/${cliente.id}/recompensas-disponibles`);
                const recompensas = await responseRecompensas.json();

                let html = `
                    <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <strong>Cliente:</strong> ${cliente.nombre} ${cliente.apellido}<br>
                        <strong>Puntos Disponibles:</strong> ${cliente.puntos_acumulados}
                    </div>
                    <h4>Recompensas que puedes canjear:</h4>
                    <div class="rewards-grid" style="margin-top: 15px;">
                `;

                if (recompensas.length === 0) {
                    html += '<p>No tienes puntos suficientes para canjear recompensas a√∫n.</p>';
                } else {
                    recompensas.forEach(recompensa => {
                        html += `
                            <div class="reward-card">
                                <h3>${recompensa.nombre}</h3>
                                <p>${recompensa.descripcion}</p>
                                <div class="reward-points">${recompensa.puntos_requeridos} puntos</div>
                                <button onclick="canjearRecompensa(${cliente.id}, ${recompensa.id})" class="btn btn-success">Canjear</button>
                            </div>
                        `;
                    });
                }

                html += '</div>';
                document.getElementById('recompensas-cliente').innerHTML = html;
            } catch (error) {
                showMessage('recompensas', '‚ùå Error al cargar recompensas', 'error');
            }
        }

        async function canjearRecompensa(clienteId, recompensaId) {
            if (!confirm('¬øEst√° seguro de canjear esta recompensa?')) return;

            try {
                const response = await fetch(`${API_URL}/canje`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({cliente_id: clienteId, recompensa_id: recompensaId})
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage('recompensas', `‚úÖ ${result.mensaje}`, 'success');
                    cargarRecompensasCliente();
                } else {
                    showMessage('recompensas', '‚ùå ' + result.error, 'error');
                }
            } catch (error) {
                showMessage('recompensas', '‚ùå Error al canjear recompensa', 'error');
            }
        }

        // ==================== FUNCIONES DE ESTAD√çSTICAS ====================
        async function cargarEstadisticas() {
            try {
                const response = await fetch(`${API_URL}/estadisticas/general`);
                const stats = await response.json();

                // Estad√≠sticas generales
                document.getElementById('stats-general').innerHTML = `
                    <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <h3>${stats.total_clientes}</h3>
                        <p>Clientes Activos</p>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                        <h3>${stats.total_compras}</h3>
                        <p>Compras Registradas</p>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                        <h3>$${stats.total_vendido.toFixed(2)}</h3>
                        <p>Total Vendido</p>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                        <h3>${stats.total_canjes}</h3>
                        <p>Recompensas Canjeadas</p>
                    </div>
                `;

                // Clientes por nivel
                let nivelesHtml = '<div class="stats-grid">';
                Object.entries(stats.clientes_por_nivel).forEach(([nivel, cantidad]) => {
                    const badgeClass = `badge-${nivel.toLowerCase()}`;
                    nivelesHtml += `
                        <div class="card">
                            <h3 style="text-align: center; font-size: 2em;">${cantidad}</h3>
                            <p style="text-align: center;"><span class="badge ${badgeClass}">${nivel}</span></p>
                        </div>
                    `;
                });
                nivelesHtml += '</div>';
                document.getElementById('stats-niveles').innerHTML = nivelesHtml;

                // Top clientes
                const responseTop = await fetch(`${API_URL}/estadisticas/clientes/top`);
                const topClientes = await responseTop.json();

                let topHtml = '<table><tr><th>Posici√≥n</th><th>Nombre</th><th>Puntos</th><th>Nivel</th></tr>';
                topClientes.forEach((cliente, index) => {
                    const badgeClass = `badge-${cliente.nivel_fidelidad.toLowerCase()}`;
                    const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                    topHtml += `
                        <tr>
                            <td>${medal} ${index + 1}</td>
                            <td>${cliente.nombre} ${cliente.apellido}</td>
                            <td><strong>${cliente.puntos_acumulados}</strong></td>
                            <td><span class="badge ${badgeClass}">${cliente.nivel_fidelidad}</span></td>
                        </tr>
                    `;
                });
                topHtml += '</table>';
                document.getElementById('top-clientes').innerHTML = topHtml;

            } catch (error) {
                console.error('Error al cargar estad√≠sticas:', error);
            }
        }

        // ==================== FUNCIONES AUXILIARES ====================
        function showMessage(section, message, type) {
            const messageDiv = document.getElementById(`message-${section}`);
            messageDiv.textContent = message;
            messageDiv.className = `message ${type} show`;
            setTimeout(() => {
                messageDiv.classList.remove('show');
            }, 5000);
        }

        // Cargar datos iniciales
        cargarClientes();
    </script>
</body>
</html>
